## Lazy loading & code-splitting (React.lazy, Suspense)

### Lazy Loading

Lazy loading is the practice of loading code or resources only when they are needed instead of at the initial load.
In React, this means delaying the loading of a component until the moment it’s actually rendered.

---

### Why?

- Improves initial load time (bundle is smaller at first).
- Reduces unnecessary code execution for routes or components the user may never visit.

---

### Code-Splitting

Code-splitting is the process of breaking your JavaScript bundle into smaller chunks.
React does this with tools like Webpack automatically when you use `React.lazy` or `import()`.

Lazy loading is one way to implement code-splitting in React.

---

### React.lazy & Suspense

- **React.lazy:** Lets you define a component that’s loaded only when it’s needed.
- **Suspense:** Displays a fallback (like a loader) while the lazy-loaded component is being fetched.

---

### Basic Example

Let’s say you have a large component called `Profile`.

**Without Lazy Loading:**

```jsx
import Profile from './Profile'; // Always loaded on initial render

function App() {
  return (
    <div>
      <Profile />
    </div>
  );
}
```

Problem: Even if the user never sees Profile, it’s still in the initial bundle.

**With Lazy Loading & Suspense:**

```jsx
import React, { Suspense, lazy } from 'react';

// Lazy load the component
const Profile = lazy(() => import('./Profile'));

function App() {
  return (
    <div>
      <Suspense fallback={<div>Loading profile...</div>}>
        <Profile />
      </Suspense>
    </div>
  );
}
```

**What happens here?**

- The `Profile` component isn’t included in the main bundle.
- When it’s about to render, React loads it dynamically (`import('./Profile')`).
- Until it’s loaded, `Suspense` shows the fallback (`Loading profile...`).

---

### Real-World Use Cases

- Route-based code splitting (lazy load pages in a SPA).
- Component-heavy pages (charts, modals, maps, etc.).
- Third-party heavy libraries (e.g., data grids, editors).

---

### Route-based Lazy Loading Example

```jsx
import { BrowserRouter as Router, Route, Routes } from 'react-router-dom';
import { Suspense, lazy } from 'react';

const Home = lazy(() => import('./pages/Home'));
const About = lazy(() => import('./pages/About'));

export default function App() {
  return (
    <Router>
      <Suspense fallback={<div>Loading page...</div>}>
        <Routes>
          <Route path="/" element={<Home />} />
          <Route path="/about" element={<About />} />
        </Routes>
      </Suspense>
    </Router>
  );
}
```

---

### Summary Table

| Concept        | Purpose                                           | Tool in React  |
| -------------- | ------------------------------------------------- | -------------- |
| Suspense       | Show a fallback while lazy-loaded component loads | `<Suspense>`   |
| Lazy Loading   | Load code only when needed                        | `React.lazy()` |
| Code-Splitting | Break bundle into smaller chunks                  | `import()`     |
