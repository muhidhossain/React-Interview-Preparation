## App Router (Next.js 13+)

### What is the App Router?

The App Router, introduced in Next.js 13, is a new routing system that:

- Uses the `app/` directory instead of `pages/`
- Fully supports React Server Components (RSC) by default
- Brings nested layouts, streaming, and data fetching per segment

It’s a more flexible, modern approach compared to the older Pages Router.

---

### Key Differences from Pages Router

| Feature         | Pages Router (`pages/`)                | App Router (`app/`)                                  |
| --------------- | -------------------------------------- | ---------------------------------------------------- |
| Directory       | `pages/`                               | `app/`                                               |
| Routing         | File-based                             | File-based, segment-driven                           |
| Data fetching   | `getStaticProps`, `getServerSideProps` | `fetch()` in Server Components (async/await)         |
| Component types | Client Components only                 | Server + Client Components                           |
| Layouts         | Manual in `_app.js`                    | Built-in nested layouts (`layout.js`)                |
| Streaming       | No                                     | Yes (React 18 Suspense + streaming)                  |
| Colocation      | Not native                             | Co-locate components, styles, tests per route folder |

---

### How Routing Works in the App Router

Each folder in `app/` represents a route segment. Special files define behavior:

| File           | Purpose                                    |
| -------------- | ------------------------------------------ |
| `page.js`      | Actual route UI (like a page)              |
| `layout.js`    | Wraps around child routes (persistent UI)  |
| `loading.js`   | Shown while route segment loads (Suspense) |
| `error.js`     | Error boundary for that route segment      |
| `not-found.js` | 404 handling for that segment              |
| `template.js`  | Like layout, but remounts on navigation    |

**Example:**

```text
app/
 ├─ layout.js        # Root layout
 ├─ page.js          # Homepage
 ├─ dashboard/
 │    ├─ layout.js   # Dashboard layout
 │    ├─ page.js     # Dashboard home
 │    ├─ settings/
 │    │     └─ page.js  # /dashboard/settings
```

---

### Server & Client Components

**Server Components (default)**

- Rendered on the server → smaller JS bundle, faster initial load.

**Client Components**

- Needed for interactivity (`useState`, `useEffect`).
- Declared by adding `'use client'` at the top of the file.

**Example:**

```js
// app/dashboard/page.js
export default async function Dashboard() {
  const data = await fetch('https://api.example.com').then((res) => res.json());
  return <div>{data.title}</div>;
}
```

---

### Data Fetching

Instead of `getServerSideProps` or `getStaticProps`, you just use `fetch()` in a Server Component — supports caching and revalidation.

Control caching with:

```js
fetch(url, { cache: 'no-store' }); // SSR
fetch(url, { next: { revalidate: 60 } }); // ISR-like
```

---

### Benefits

- Nested layouts → Reuse UI between pages without re-render.
- Streaming → Show partial UI as soon as it’s ready.
- Server-first → Better performance by default.
- Colocation → Keep route code, styles, and tests together.

---

### Common Interview Questions

- What’s the difference between the App Router and Pages Router in Next.js?
- How do you fetch data in the App Router without `getServerSideProps`?
- How do you create nested layouts in Next.js 13+?
- How do Server and Client Components work together?
- How do you implement ISR in the App Router?
