## State Reducers

### Definition

A State Reducer is a pattern in React for giving consumers full control over how state changes inside a reusable component.

Instead of hardcoding how state updates happen, the component calls a reducer function (provided by the user) to determine the next state.

Think of it as: "The component owns the state, but you decide how it changes."

---

### Why It Exists

When building reusable components (UI libraries, hooks), you might want consumers to customize state transitions without rewriting the component.
Inspired by the Redux reducer pattern (state in → action → new state).
Used heavily by downshift (Kent C. Dodds’ autocomplete library).

---

### Basic Concept Formula

```
nextState = reducer(currentState, action)
```

- `currentState` → The state before the update
- `action` → An object describing what happened
- `nextState` → The new state returned by the reducer

---

### Simple Example: Toggle with State Reducer

```jsx
import { useState } from 'react';

function useToggle({ initialOn = false, reducer }) {
  const [state, setState] = useState({ on: initialOn });

  const toggle = () => {
    const changes = { on: !state.on };
    setState((currentState) =>
      reducer ? reducer(currentState, changes) : changes
    );
  };

  return { on: state.on, toggle };
}

// Usage
function App() {
  const toggleReducer = (state, changes) => {
    // Prevent turning on if already on
    if (state.on && changes.on) return state;
    return changes;
  };

  const { on, toggle } = useToggle({ reducer: toggleReducer });

  return (
    <div>
      <button onClick={toggle}>{on ? 'ON' : 'OFF'}</button>
    </div>
  );
}
```

---

### Key Points

- The component/hook manages the state internally.
- The user’s reducer decides how updates happen.
- The reducer can:
  - Allow the update (return new state)
  - Modify the update (return altered state)
  - Block the update (return current state)

---

### Pros & Cons

✅ **Pros**

- Highly customizable behavior
- Great for reusable libraries
- No need to fork/modify the original component

⚠️ **Cons**

- Adds complexity
- Overkill for simple components
- Users must understand reducer pattern

---

### Real-world Examples

- Downshift (autocomplete) → lets you override selection logic
- React Table → custom reducers for sorting/filtering
- Custom hooks in design systems

---

### Interview Tip

If asked:

> “Why not just use useReducer or props?”
> You can say:
> useReducer is internal — the component decides updates.
> State Reducer Pattern lets external consumers intercept & customize state updates.
> Useful when you want to share control between component and consumer.

---

### One-liner Summary

A state reducer is a pattern where a component manages its own state but lets the consumer control how state changes by providing a reducer function.
